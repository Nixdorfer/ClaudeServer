import{d as e,r as t,c as n,a as s,b as i,n as r,F as o,t as l,e as a,f as c,g as u,h as d,T as v,i as f,o as m,w as p,v as h,j as g,k as w,u as b,l as x,m as y,p as k,q as z,s as C,x as _,y as S,z as j,A as M}from"./ce807677.js";import{m as L}from"./e39c2fc6.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();function T(e=21){let t="",n=0|e;for(;n--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return t}const E=window.location.origin+"/wails/runtime",D=Object.freeze({Call:0,Clipboard:1,Application:2,Events:3,ContextMenu:4,Dialog:5,Window:6,Screens:7,System:8,Browser:9,CancelCall:10,IOS:11});let P=T();function B(e,t=""){return function(n,s=null){return async function(e,t,n,s){var i,r;let o=new URL(E),l={object:e,method:t};null!=s&&(l.args=s);let a={"x-wails-client-id":P,"Content-Type":"application/json"};n&&(a["x-wails-window-name"]=n);let c=await fetch(o,{method:"POST",headers:a,body:JSON.stringify(l)});if(!c.ok)throw new Error(await c.text());return-1!==(null!==(r=null===(i=c.headers.get("Content-Type"))||void 0===i?void 0:i.indexOf("application/json"))&&void 0!==r?r:-1)?c.json():c.text()}(e,n,t,s)}}B(D.System);const F=function(){var e,t,n,s,i,r;try{if(null===(t=null===(e=window.chrome)||void 0===e?void 0:e.webview)||void 0===t?void 0:t.postMessage)return window.chrome.webview.postMessage.bind(window.chrome.webview);if(null===(i=null===(s=null===(n=window.webkit)||void 0===n?void 0:n.messageHandlers)||void 0===s?void 0:s.external)||void 0===i?void 0:i.postMessage)return window.webkit.messageHandlers.external.postMessage.bind(window.webkit.messageHandlers.external);if(null===(r=window.wails)||void 0===r?void 0:r.invoke)return e=>window.wails.invoke("string"==typeof e?e:JSON.stringify(e))}catch(o){}return null}();function O(e){null==F||F(e)}function H(){var e,t;return"windows"===(null===(t=null===(e=window._wails)||void 0===e?void 0:e.environment)||void 0===t?void 0:t.OS)}function A(e){var t;return e.target instanceof HTMLElement?e.target:!(e.target instanceof HTMLElement)&&e.target instanceof Node&&null!==(t=e.target.parentElement)&&void 0!==t?t:document.body}document.addEventListener("DOMContentLoaded",()=>{}),window.addEventListener("contextmenu",function(e){const t=A(e),n=window.getComputedStyle(t).getPropertyValue("--custom-contextmenu").trim();if(n){e.preventDefault();const s=window.getComputedStyle(t).getPropertyValue("--custom-contextmenu-data");!function(e,t,n,s){R(I,{id:e,x:t,y:n,data:s})}(n,e.clientX,e.clientY,s)}else!function(e,t){if(Boolean(null===(s=null===(n=window._wails)||void 0===n?void 0:n.environment)||void 0===s?void 0:s.Debug))return;var n,s;switch(window.getComputedStyle(t).getPropertyValue("--default-contextmenu").trim()){case"show":return;case"hide":return void e.preventDefault()}if(t.isContentEditable)return;const i=window.getSelection(),r=i&&i.toString().length>0;if(r)for(let o=0;o<i.rangeCount;o++){const e=i.getRangeAt(o).getClientRects();for(let n=0;n<e.length;n++){const s=e[n];if(document.elementFromPoint(s.left,s.top)===t)return}}if((t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement)&&(r||!t.readOnly&&!t.disabled))return;e.preventDefault()}(e,t)});const R=B(D.ContextMenu),I=0;function N(e){try{return window._wails.flags[e]}catch(t){throw new Error("Unable to retrieve flag '"+e+"': "+t,{cause:t})}}let U=!1,W=!1,V=!1,G=!1,$=!1,X="",Y="auto",Q=0;const Z=0===new MouseEvent("mousedown").buttons;window._wails=window._wails||{},window._wails.setResizable=e=>{V=e,V||(G=$=!1,le())};let K=!1;function q(){if(!K&&!function(){var e,t;const n=null===(t=null===(e=window._wails)||void 0===e?void 0:e.environment)||void 0===t?void 0:t.OS;if("ios"===n||"android"===n)return!0;const s=navigator.userAgent||navigator.vendor||window.opera||"";return/android|iphone|ipad|ipod|iemobile|wpdesktop/i.test(s)}()){window.addEventListener("mousedown",re,{capture:!0}),window.addEventListener("mousemove",re,{capture:!0}),window.addEventListener("mouseup",re,{capture:!0});for(const e of["click","contextmenu","dblclick"])window.addEventListener(e,te,{capture:!0});K=!0}}q(),document.addEventListener("DOMContentLoaded",q,{once:!0});let J=0;const ee=window.setInterval(()=>{K?window.clearInterval(ee):(q(),++J>100&&window.clearInterval(ee))},50);function te(e){(W||$)&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault())}const ne=0,se=1,ie=2;function re(e){let t,n=e.buttons;switch(e.type){case"mousedown":t=ne,Z||(n=Q|1<<e.button);break;case"mouseup":t=se,Z||(n=Q&~(1<<e.button));break;default:t=ie,Z||(n=Q)}let s=Q&~n,i=n&~Q;Q=n,t!==ne||i&e.button||(s|=1<<e.button,i|=1<<e.button),(t!==ie&&$||W&&(t===ne||0!==e.button))&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()),1&s&&(U=!1,W=!1,G=!1,$=!1),1&i&&function(e){if(U=!1,G=!1,!H()&&"mousedown"===e.type&&0===e.button&&1!==e.detail)return;if(X)return void(G=!0);const t=A(e),n=window.getComputedStyle(t);U="drag"===n.getPropertyValue("--wails-draggable").trim()&&e.offsetX-parseFloat(n.paddingLeft)<t.clientWidth&&e.offsetY-parseFloat(n.paddingTop)<t.clientHeight}(e),t===ie&&function(e){G&&X?($=!0,O("wails:resize:"+X)):U&&(W=!0,O("wails:drag"));if(W||$)return void(U=G=!1);if(!V||!H())return void(X&&le());const t=N("system.resizeHandleHeight")||5,n=N("system.resizeHandleWidth")||5,s=N("resizeCornerExtra")||10,i=window.outerWidth-e.clientX<n,r=e.clientX<n,o=e.clientY<t,l=window.outerHeight-e.clientY<t,a=window.outerWidth-e.clientX<n+s,c=e.clientX<n+s,u=e.clientY<t+s,d=window.outerHeight-e.clientY<t+s;c||u||d||a?a&&d?le("se-resize"):c&&d?le("sw-resize"):c&&u?le("nw-resize"):u&&a?le("ne-resize"):r?le("w-resize"):o?le("n-resize"):l?le("s-resize"):i?le("e-resize"):le():le()}(e)}const oe=Object.freeze({"se-resize":"nwse-resize","sw-resize":"nesw-resize","nw-resize":"nwse-resize","ne-resize":"nesw-resize","w-resize":"ew-resize","n-resize":"ns-resize","s-resize":"ns-resize","e-resize":"ew-resize"});function le(e){e?(X||(Y=document.body.style.cursor),document.body.style.cursor=oe[e]):!e&&X&&(document.body.style.cursor=Y),X=e||""}const ae=B(D.Browser);var ce,ue,de=Function.prototype.toString,ve="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof ve&&"function"==typeof Object.defineProperty)try{ce=Object.defineProperty({},"length",{get:function(){throw ue}}),ue={},ve(function(){throw 42},null,ce)}catch(cs){cs!==ue&&(ve=null)}else ve=null;var fe=/^\s*class\b/,me=function(e){try{var t=de.call(e);return fe.test(t)}catch(n){return!1}},pe=function(e){try{return!me(e)&&(de.call(e),!0)}catch(t){return!1}},he=Object.prototype.toString,ge="function"==typeof Symbol&&!!Symbol.toStringTag,we=!(0 in[,]),be=function(){return!1};if("object"==typeof document){var xe=document.all;he.call(xe)===he.call(document.all)&&(be=function(e){if((we||!e)&&(void 0===e||"object"==typeof e))try{var t=he.call(e);return("[object HTMLAllCollection]"===t||"[object HTML document.all class]"===t||"[object HTMLCollection]"===t||"[object Object]"===t)&&null==e("")}catch(n){}return!1})}const ye=ve?function(e){if(be(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;try{ve(e,null,ce)}catch(t){if(t!==ue)return!1}return!me(e)&&pe(e)}:function(e){if(be(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if(ge)return pe(e);if(me(e))return!1;var t=he.call(e);return!("[object Function]"!==t&&"[object GeneratorFunction]"!==t&&!/^\[object HTML/.test(t))&&pe(e)};var ke;class ze extends Error{constructor(e,t){super(e,t),this.name="CancelError"}}class Ce extends Error{constructor(e,t,n){super((null!=n?n:"Unhandled rejection in cancelled promise.")+" Reason: "+function(e){try{if(e instanceof Error||"object"!=typeof e||e.toString!==Object.prototype.toString)return""+e}catch(t){}try{return JSON.stringify(e)}catch(n){}try{return Object.prototype.toString.call(e)}catch(s){}return"<could not convert error to string>"}(t),{cause:t}),this.promise=e,this.name="CancelledRejectionError"}}const _e=Symbol("barrier"),Se=Symbol("cancelImpl"),je=null!==(ke=Symbol.species)&&void 0!==ke?ke:Symbol("speciesPolyfill");class Me extends Promise{constructor(e,t){let n,s;if(super((e,t)=>{n=e,s=t}),this.constructor[je]!==Promise)throw new TypeError("CancellablePromise does not support transparent subclassing. Please refrain from overriding the [Symbol.species] static property.");let i={promise:this,resolve:n,reject:s,get oncancelled(){return null!=t?t:null},set oncancelled(e){t=null!=e?e:void 0}};const r={get root(){return r},resolving:!1,settled:!1};Object.defineProperties(this,{[_e]:{configurable:!1,enumerable:!1,writable:!0,value:null},[Se]:{configurable:!1,enumerable:!1,writable:!1,value:Le(i,r)}});const o=Ee(i,r);try{e(Te(i,r),o)}catch(l){r.resolving||o(l)}}cancel(e){return new Me(t=>{Promise.all([this[Se](new ze("Promise cancelled.",{cause:e})),Fe(this)]).then(()=>t(),()=>t())})}cancelOn(e){return e.aborted?this.cancel(e.reason):e.addEventListener("abort",()=>{this.cancel(e.reason)},{capture:!0}),this}then(e,t,n){if(!(this instanceof Me))throw new TypeError("CancellablePromise.prototype.then called on an invalid object.");if(ye(e)||(e=Pe),ye(t)||(t=Be),e===Pe&&t==Be)return new Me(e=>e(this));const s={};return this[_e]=s,new Me((n,i)=>{super.then(t=>{var r;this[_e]===s&&(this[_e]=null),null===(r=s.resolve)||void 0===r||r.call(s);try{n(e(t))}catch(o){i(o)}},e=>{var r;this[_e]===s&&(this[_e]=null),null===(r=s.resolve)||void 0===r||r.call(s);try{n(t(e))}catch(o){i(o)}})},async e=>{try{return null==n?void 0:n(e)}finally{await this.cancel(e)}})}catch(e,t){return this.then(void 0,e,t)}finally(e,t){if(!(this instanceof Me))throw new TypeError("CancellablePromise.prototype.finally called on an invalid object.");return ye(e)?this.then(t=>Me.resolve(e()).then(()=>t),t=>Me.resolve(e()).then(()=>{throw t}),t):this.then(e,e,t)}static get[je](){return Promise}static all(e){let t=Array.from(e);const n=0===t.length?Me.resolve(t):new Me((e,n)=>{Promise.all(t).then(e,n)},e=>De(n,t,e));return n}static allSettled(e){let t=Array.from(e);const n=0===t.length?Me.resolve(t):new Me((e,n)=>{Promise.allSettled(t).then(e,n)},e=>De(n,t,e));return n}static any(e){let t=Array.from(e);const n=0===t.length?Me.resolve(t):new Me((e,n)=>{Promise.any(t).then(e,n)},e=>De(n,t,e));return n}static race(e){let t=Array.from(e);const n=new Me((e,n)=>{Promise.race(t).then(e,n)},e=>De(n,t,e));return n}static cancel(e){const t=new Me(()=>{});return t.cancel(e),t}static timeout(e,t){const n=new Me(()=>{});return AbortSignal&&"function"==typeof AbortSignal&&AbortSignal.timeout&&"function"==typeof AbortSignal.timeout?AbortSignal.timeout(e).addEventListener("abort",()=>{n.cancel(t)}):setTimeout(()=>{n.cancel(t)},e),n}static sleep(e,t){return new Me(n=>{setTimeout(()=>n(t),e)})}static reject(e){return new Me((t,n)=>n(e))}static resolve(e){return e instanceof Me?e:new Me(t=>t(e))}static withResolvers(){let e={oncancelled:null};return e.promise=new Me((t,n)=>{e.resolve=t,e.reject=n},t=>{var n;null===(n=e.oncancelled)||void 0===n||n.call(e,t)}),e}}function Le(e,t){let n;return s=>{if(t.settled||(t.settled=!0,t.reason=s,e.reject(s),Promise.prototype.then.call(e.promise,void 0,e=>{if(e!==s)throw e})),t.reason&&e.oncancelled)return n=new Promise(n=>{try{n(e.oncancelled(t.reason.cause))}catch(s){Promise.reject(new Ce(e.promise,s,"Unhandled exception in oncancelled callback."))}}).catch(t=>{Promise.reject(new Ce(e.promise,t,"Unhandled rejection in oncancelled callback."))}),e.oncancelled=null,n}}function Te(e,t){return n=>{if(!t.resolving){if(t.resolving=!0,n===e.promise){if(t.settled)return;return t.settled=!0,void e.reject(new TypeError("A promise cannot be resolved with itself."))}if(null!=n&&("object"==typeof n||"function"==typeof n)){let r;try{r=n.then}catch(s){return t.settled=!0,void e.reject(s)}if(ye(r)){try{let s=n.cancel;if(ye(s)){const i=e=>{Reflect.apply(s,n,[e])};t.reason?Le(Object.assign(Object.assign({},e),{oncancelled:i}),t)(t.reason):e.oncancelled=i}}catch(i){}const o={root:t.root,resolving:!1,get settled(){return this.root.settled},set settled(e){this.root.settled=e},get reason(){return this.root.reason}},l=Ee(e,o);try{Reflect.apply(r,n,[Te(e,o),l])}catch(s){l(s)}return}}t.settled||(t.settled=!0,e.resolve(n))}}}function Ee(e,t){return n=>{if(!t.resolving)if(t.resolving=!0,t.settled){try{if(n instanceof ze&&t.reason instanceof ze&&Object.is(n.cause,t.reason.cause))return}catch(s){}Promise.reject(new Ce(e.promise,n))}else t.settled=!0,e.reject(n)}}function De(e,t,n){const s=[];for(const o of t){let t,l;try{if(!ye(o.then))continue;if(t=o.cancel,!ye(t))continue}catch(i){continue}try{l=Reflect.apply(t,o,[n])}catch(r){Promise.reject(new Ce(e,r,"Unhandled exception in cancel method."));continue}l&&s.push((l instanceof Promise?l:Promise.resolve(l)).catch(t=>{Promise.reject(new Ce(e,t,"Unhandled rejection in cancel method."))}))}return Promise.all(s)}function Pe(e){return e}function Be(e){throw e}function Fe(e){var t;let n=null!==(t=e[_e])&&void 0!==t?t:{};return"promise"in n||Object.assign(n,Oe()),null==e[_e]&&(n.resolve(),e[_e]=n),n.promise}let Oe=Promise.withResolvers;Oe=Oe&&"function"==typeof Oe?Oe.bind(Promise):function(){let e,t;return{promise:new Promise((n,s)=>{e=n,t=s}),resolve:e,reject:t}},window._wails=window._wails||{};const He=B(D.Call),Ae=B(D.CancelCall),Re=new Map;function Ie(e){const t=function(){let e;do{e=T()}while(Re.has(e));return e}(),n=Me.withResolvers();Re.set(t,{resolve:n.resolve,reject:n.reject});const s=He(0,Object.assign({"call-id":t},e));let i=!0;s.then(e=>{i=!1,Re.delete(t),n.resolve(e)},e=>{i=!1,Re.delete(t),n.reject(e)});const r=()=>(Re.delete(t),Ae(0,{"call-id":t}).catch(e=>{}));return n.oncancelled=()=>i?r():s.then(r),n.promise}function Ne(e,...t){return Ie({methodName:e,args:t})}const Ue={},We=new Map;class Ve{constructor(e,t,n){this.eventName=e,this.callback=t,this.maxCallbacks=n||-1}dispatch(e){try{this.callback(e)}catch(t){}return-1!==this.maxCallbacks&&(this.maxCallbacks-=1,0===this.maxCallbacks)}}window._wails=window._wails||{},window._wails.dispatchWailsEvent=function(e){let t=We.get(e.name);if(!t)return;let n=new Ge(e.name,e.name in Ue?Ue[e.name](e.data):e.data);"sender"in e&&(n.sender=e.sender);t=t.filter(e=>!e.dispatch(n)),0===t.length?We.delete(e.name):We.set(e.name,t)},B(D.Events);class Ge{constructor(e,t){this.name=e,this.data=null!=t?t:null}}function $e(e,t,n){let s=We.get(e)||[];const i=new Ve(e,t,n);return s.push(i),We.set(e,s),()=>function(e){let t=We.get(e.eventName);t&&(t=t.filter(t=>t!==e),0===t.length?We.delete(e.eventName):We.set(e.eventName,t))}(i)}function Xe(e,t){return $e(e,t,-1)}const Ye="file-drop-target-active";let Qe=null;function Ze(e){return e?e.closest("[data-file-drop-target]"):null}let Ke=!1;function qe(){Ke=!1,Qe&&(Qe.classList.remove(Ye),Qe=null)}const Je=Symbol("caller");class et{constructor(e=""){this[Je]=B(D.Window,e);for(const t of Object.getOwnPropertyNames(et.prototype))"constructor"!==t&&"function"==typeof this[t]&&(this[t]=this[t].bind(this))}Get(e){return new et(e)}Position(){return this[Je](0)}Center(){return this[Je](1)}Close(){return this[Je](2)}DisableSizeConstraints(){return this[Je](3)}EnableSizeConstraints(){return this[Je](4)}Focus(){return this[Je](5)}ForceReload(){return this[Je](6)}Fullscreen(){return this[Je](7)}GetScreen(){return this[Je](8)}GetZoom(){return this[Je](9)}Height(){return this[Je](10)}Hide(){return this[Je](11)}IsFocused(){return this[Je](12)}IsFullscreen(){return this[Je](13)}IsMaximised(){return this[Je](14)}IsMinimised(){return this[Je](15)}Maximise(){return this[Je](16)}Minimise(){return this[Je](17)}Name(){return this[Je](18)}OpenDevTools(){return this[Je](19)}RelativePosition(){return this[Je](20)}Reload(){return this[Je](21)}Resizable(){return this[Je](22)}Restore(){return this[Je](23)}SetPosition(e,t){return this[Je](24,{x:e,y:t})}SetAlwaysOnTop(e){return this[Je](25,{alwaysOnTop:e})}SetBackgroundColour(e,t,n,s){return this[Je](26,{r:e,g:t,b:n,a:s})}SetFrameless(e){return this[Je](27,{frameless:e})}SetFullscreenButtonEnabled(e){return this[Je](28,{enabled:e})}SetMaxSize(e,t){return this[Je](29,{width:e,height:t})}SetMinSize(e,t){return this[Je](30,{width:e,height:t})}SetRelativePosition(e,t){return this[Je](31,{x:e,y:t})}SetResizable(e){return this[Je](32,{resizable:e})}SetSize(e,t){return this[Je](33,{width:e,height:t})}SetTitle(e){return this[Je](34,{title:e})}SetZoom(e){return this[Je](35,{zoom:e})}Show(){return this[Je](36)}Size(){return this[Je](37)}ToggleFullscreen(){return this[Je](38)}ToggleMaximise(){return this[Je](39)}ToggleFrameless(){return this[Je](40)}UnFullscreen(){return this[Je](41)}UnMaximise(){return this[Je](42)}UnMinimise(){return this[Je](43)}Width(){return this[Je](44)}Zoom(){return this[Je](45)}ZoomIn(){return this[Je](46)}ZoomOut(){return this[Je](47)}ZoomReset(){return this[Je](48)}HandlePlatformFileDrop(e,t,n){var s,i;if(!1===(null===(i=null===(s=window._wails)||void 0===s?void 0:s.flags)||void 0===i?void 0:i.enableFileDrop))return;const r=Ze(document.elementFromPoint(t,n));if(!r)return;const o={id:r.id,classList:Array.from(r.classList),attributes:{}};for(let a=0;a<r.attributes.length;a++){const e=r.attributes[a];o.attributes[e.name]=e.value}const l={filenames:e,x:t,y:n,elementDetails:o};this[Je](50,l),qe()}SnapAssist(){return this[Je](49)}Print(){return this[Je](51)}}const tt=new et("");"undefined"!=typeof window&&"undefined"!=typeof document&&function(){const e=document.documentElement;let t=0;e.addEventListener("dragenter",e=>{var n,s,i;if(!(null===(n=e.dataTransfer)||void 0===n?void 0:n.types.includes("Files")))return;if(e.preventDefault(),!1===(null===(i=null===(s=window._wails)||void 0===s?void 0:s.flags)||void 0===i?void 0:i.enableFileDrop))return void(e.dataTransfer.dropEffect="none");t++;const r=Ze(document.elementFromPoint(e.clientX,e.clientY));Qe&&Qe!==r&&Qe.classList.remove(Ye),r?(r.classList.add(Ye),e.dataTransfer.dropEffect="copy",Qe=r):(e.dataTransfer.dropEffect="none",Qe=null)},!1),e.addEventListener("dragover",e=>{var t,n,s;if(!(null===(t=e.dataTransfer)||void 0===t?void 0:t.types.includes("Files")))return;if(e.preventDefault(),!1===(null===(s=null===(n=window._wails)||void 0===n?void 0:n.flags)||void 0===s?void 0:s.enableFileDrop))return void(e.dataTransfer.dropEffect="none");const i=Ze(document.elementFromPoint(e.clientX,e.clientY));Qe&&Qe!==i&&Qe.classList.remove(Ye),i?(i.classList.contains(Ye)||i.classList.add(Ye),e.dataTransfer.dropEffect="copy",Qe=i):(e.dataTransfer.dropEffect="none",Qe=null)},!1),e.addEventListener("dragleave",e=>{var n,s,i;(null===(n=e.dataTransfer)||void 0===n?void 0:n.types.includes("Files"))&&(e.preventDefault(),!1!==(null===(i=null===(s=window._wails)||void 0===s?void 0:s.flags)||void 0===i?void 0:i.enableFileDrop)&&null!==e.relatedTarget&&(t--,(0===t||Qe&&!Qe.contains(e.relatedTarget))&&(Qe&&(Qe.classList.remove(Ye),Qe=null),t=0)))},!1),e.addEventListener("drop",e=>{var n,s,i;if((null===(n=e.dataTransfer)||void 0===n?void 0:n.types.includes("Files"))&&(e.preventDefault(),!1!==(null===(i=null===(s=window._wails)||void 0===s?void 0:s.flags)||void 0===i?void 0:i.enableFileDrop)&&(t=0,Qe&&(Qe.classList.remove(Ye),Qe=null),function(){var e,t,n,s;return null!=(null===(t=null===(e=window.chrome)||void 0===e?void 0:e.webview)||void 0===t?void 0:t.postMessageWithAdditionalObjects)&&!0===(null===(s=null===(n=window._wails)||void 0===n?void 0:n.flags)||void 0===s?void 0:s.enableFileDrop)}()))){const t=[];if(e.dataTransfer.items){for(const n of e.dataTransfer.items)if("file"===n.kind){const e=n.getAsFile();e&&t.push(e)}}else if(e.dataTransfer.files)for(const n of e.dataTransfer.files)t.push(n);t.length>0&&function(e,t,n){var s,i;(null===(i=null===(s=window.chrome)||void 0===s?void 0:s.webview)||void 0===i?void 0:i.postMessageWithAdditionalObjects)&&window.chrome.webview.postMessageWithAdditionalObjects(`file:drop:${e}:${t}`,n)}(e.clientX,e.clientY,t)}},!1)}();const nt=tt;window._wails=window._wails||{},window._wails.invoke=O,window._wails.handlePlatformFileDrop=nt.HandlePlatformFileDrop.bind(nt),window._wails.handleDragEnter=function(){var e,t;!1!==(null===(t=null===(e=window._wails)||void 0===e?void 0:e.flags)||void 0===t?void 0:t.enableFileDrop)&&(Ke=!0)},window._wails.handleDragLeave=function(){qe()},window._wails.handleDragOver=function(e,t){var n,s;if(!Ke)return;if(!1===(null===(s=null===(n=window._wails)||void 0===n?void 0:n.flags)||void 0===s?void 0:s.enableFileDrop))return;const i=Ze(document.elementFromPoint(e,t));Qe&&Qe!==i&&Qe.classList.remove(Ye),i?(i.classList.add(Ye),Qe=i):Qe=null},O("wails:runtime:ready");const st={class:"p-4 border-b border-zinc-800"},it={class:"px-4 py-2 text-xs flex items-center gap-2"},rt={class:"text-zinc-400"},ot={key:0},lt={key:0,class:"px-4 py-3 border-b border-zinc-800"},at={key:0,class:"mb-2 p-2 bg-red-900/30 border border-red-700 rounded-lg"},ct={class:"text-xs text-red-400 whitespace-pre-line"},ut={class:"space-y-2"},dt={class:"flex justify-between items-center"},vt={class:"w-full bg-zinc-700 rounded-full h-1.5"},ft={class:"flex justify-between items-center mt-2"},mt={class:"w-full bg-zinc-700 rounded-full h-1.5"},pt={class:"flex justify-between items-center mt-2"},ht={class:"text-xs font-medium text-zinc-300"},gt={class:"w-full bg-zinc-700 rounded-full h-1.5"},wt={class:"flex-1 overflow-y-auto"},bt={class:"p-2 space-y-1"},xt=["onClick","onContextmenu"],yt={class:"flex items-start justify-between gap-2"},kt={class:"flex-1 min-w-0"},zt={key:1,class:"text-sm text-zinc-200 truncate"},Ct={class:"flex items-center gap-2 mt-1"},_t={class:"text-xs text-zinc-500"},St={class:"text-xs text-zinc-600"},jt={key:0,class:"flex-shrink-0 w-2 h-2 bg-btn-primary rounded-full animate-pulse"},Mt={key:0,class:"text-center py-8 text-zinc-500 text-sm"},Lt={class:"p-4 border-t border-zinc-800 text-xs text-zinc-500 text-center"},Tt={key:0,class:"mt-1 text-zinc-600"},Et=e({__name:"Sidebar",props:{conversations:{},currentId:{},isConnected:{type:Boolean},isConnecting:{type:Boolean},reconnectAttempts:{},usageStatus:{},usageBlocked:{type:Boolean},usageBlockMessage:{},version:{}},emits:["select","newChat","reconnect","rename","delete"],setup(e,{emit:w}){const b=w,x=t(null),y=t(""),k=t(null),z=t(null),C=t({x:0,y:0});function _(e){const t=new Date(e),n=(new Date).getTime()-t.getTime(),s=Math.floor(n/864e5);return 0===s?t.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):1===s?"昨天":s<7?`${s}天前`:t.toLocaleDateString("zh-CN",{month:"short",day:"numeric"})}function S(e,t=30){return e?e.length>t?e.slice(0,t)+"...":e:"新对话"}function j(){z.value=null}function M(){x.value&&y.value.trim()&&b("rename",x.value,y.value.trim()),L()}function L(){x.value=null,y.value=""}function T(e){"Enter"===e.key?(e.preventDefault(),M()):"Escape"===e.key&&L()}function E(e){e.target.closest(".context-menu")||j()}return(t,w)=>(m(),n("div",{class:"w-64 bg-sidebar-bg h-full flex flex-col border-r border-zinc-800",onClick:E},[s("div",st,[s("button",{onClick:w[0]||(w[0]=e=>b("newChat")),class:"w-full py-2.5 px-4 bg-btn-primary hover:bg-btn-hover text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2"},[...w[6]||(w[6]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),i(" 新对话 ",-1)])])]),s("div",it,[s("span",{class:r(["w-2 h-2 rounded-full",[e.isConnected?"bg-green-500":e.isConnecting?"bg-blue-500 animate-pulse":"bg-red-500"]])},null,2),s("span",rt,[e.isConnected?(m(),n(o,{key:0},[i("已连接")],64)):e.isConnecting?(m(),n(o,{key:1},[w[7]||(w[7]=i(" 正在连接",-1)),e.reconnectAttempts>0?(m(),n("span",ot," ("+l(e.reconnectAttempts)+"/5)",1)):a("",!0)],64)):(m(),n(o,{key:2},[i("连接失败")],64))]),e.isConnected||e.isConnecting?a("",!0):(m(),n("button",{key:0,onClick:w[1]||(w[1]=e=>b("reconnect")),class:"ml-auto text-btn-primary hover:text-btn-hover text-xs"}," 重新连接 "))]),e.usageStatus?(m(),n("div",lt,[e.usageBlocked?(m(),n("div",at,[s("p",ct,l(e.usageBlockMessage),1)])):a("",!0),s("div",ut,[s("div",dt,[w[8]||(w[8]=s("span",{class:"text-xs text-zinc-500"},"5小时用量",-1)),s("span",{class:r(["text-xs font-medium",e.usageStatus.five_hour>e.usageStatus.limit_five_hour?"text-red-400":"text-zinc-300"])},l(e.usageStatus.five_hour.toFixed(1))+"% ",3)]),s("div",vt,[s("div",{class:r(["h-1.5 rounded-full transition-all duration-300",e.usageStatus.five_hour>e.usageStatus.limit_five_hour?"bg-red-500":"bg-btn-primary"]),style:c({width:Math.min(e.usageStatus.five_hour,100)+"%"})},null,6)]),s("div",ft,[w[9]||(w[9]=s("span",{class:"text-xs text-zinc-500"},"周总用量",-1)),s("span",{class:r(["text-xs font-medium",e.usageStatus.seven_day>e.usageStatus.limit_seven_day?"text-red-400":"text-zinc-300"])},l(e.usageStatus.seven_day.toFixed(1))+"% ",3)]),s("div",mt,[s("div",{class:r(["h-1.5 rounded-full transition-all duration-300",e.usageStatus.seven_day>e.usageStatus.limit_seven_day?"bg-red-500":"bg-btn-primary"]),style:c({width:Math.min(e.usageStatus.seven_day,100)+"%"})},null,6)]),s("div",pt,[w[10]||(w[10]=s("span",{class:"text-xs text-zinc-500"},"周Sonnet用量",-1)),s("span",ht,l(e.usageStatus.seven_day_sonnet.toFixed(1))+"% ",1)]),s("div",gt,[s("div",{class:"h-1.5 rounded-full bg-blue-500 transition-all duration-300",style:c({width:Math.min(e.usageStatus.seven_day_sonnet,100)+"%"})},null,4)])])])):a("",!0),s("div",wt,[s("div",bt,[(m(!0),n(o,null,u(e.conversations,t=>(m(),n("div",{key:t.conversation_id,onClick:e=>x.value!==t.conversation_id&&b("select",t.conversation_id),onContextmenu:e=>function(e,t){e.preventDefault(),z.value=t.conversation_id,C.value={x:e.clientX,y:e.clientY}}(e,t),class:r(["group p-3 rounded-lg cursor-pointer transition-colors",[t.conversation_id===e.currentId?"bg-input-bg":"hover:bg-input-bg/50"]])},[s("div",yt,[s("div",kt,[x.value===t.conversation_id?p((m(),n("input",{key:0,ref_for:!0,ref_key:"editInputRef",ref:k,"onUpdate:modelValue":w[2]||(w[2]=e=>y.value=e),onBlur:M,onKeydown:T,onClick:w[3]||(w[3]=g(()=>{},["stop"])),class:"w-full text-sm text-zinc-200 bg-zinc-700 border border-zinc-600 rounded px-1.5 py-0.5 outline-none focus:border-btn-primary"},null,544)),[[h,y.value]]):(m(),n("p",zt,l(t.name||S(t.first_message||"")),1)),s("div",Ct,[s("span",_t,l(t.message_count)+" 条消息 ",1),s("span",St,l(_(t.last_used_time)),1)])]),t.is_generating?(m(),n("span",jt)):a("",!0)])],42,xt))),128)),0===e.conversations.length?(m(),n("div",Mt," 暂无对话记录 ")):a("",!0)])]),s("div",Lt,[w[11]||(w[11]=s("div",null,"Claude 对话客户端",-1)),e.version?(m(),n("div",Tt,"v"+l(e.version),1)):a("",!0)]),(m(),d(v,{to:"body"},[z.value?(m(),n("div",{key:0,class:"context-menu fixed bg-zinc-800 border border-zinc-700 rounded-lg shadow-xl py-1 z-50 min-w-[120px]",style:c({left:C.value.x+"px",top:C.value.y+"px"})},[s("button",{onClick:w[4]||(w[4]=t=>async function(e){x.value=e.conversation_id,y.value=e.name||e.first_message||"",j(),await f(),k.value?.focus(),k.value?.select()}(e.conversations.find(e=>e.conversation_id===z.value))),class:"w-full px-3 py-2 text-left text-sm text-zinc-200 hover:bg-zinc-700 flex items-center gap-2"},[...w[12]||(w[12]=[s("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),i(" 重命名 ",-1)])]),s("button",{onClick:w[5]||(w[5]=e=>{return t=z.value,b("delete",t),void j();var t}),class:"w-full px-3 py-2 text-left text-sm text-red-400 hover:bg-zinc-700 flex items-center gap-2"},[...w[13]||(w[13]=[s("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),i(" 删除 ",-1)])])],4)):a("",!0)]))]))}}),Dt="/assets/3581aa6e.ico",Pt={class:"max-w-3xl mx-auto px-4 flex gap-4"},Bt=["src"],Ft={key:1,class:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium bg-btn-primary"},Ot={class:"flex-1 min-w-0"},Ht={class:"text-xs text-zinc-500 mb-1"},At=["innerHTML"],Rt={key:0,class:"inline-flex gap-1"},It={key:1,class:"inline-block w-2 h-4 bg-zinc-400 animate-pulse ml-0.5"},Nt=(e,t)=>{const n=e.__vccOpts||e;for(const[s,i]of t)n[s]=i;return n},Ut=Nt(e({__name:"MessageItem",props:{message:{}},setup(e){const t=e;L.setOptions({breaks:!0,gfm:!0});const i=w(()=>t.message.content?L.parse(t.message.content):"");return(t,o)=>(m(),n("div",{class:r(["message-enter py-4","user"===e.message.role?"bg-transparent":"bg-input-bg/30"])},[s("div",Pt,["assistant"===e.message.role?(m(),n("img",{key:0,src:b(Dt),alt:"Claude",class:"flex-shrink-0 w-8 h-8 rounded-full"},null,8,Bt)):(m(),n("div",Ft," U ")),s("div",Ot,[s("div",Ht,l("user"===e.message.role?"你":"Claude"),1),s("div",{class:"message-content text-zinc-200 break-words",innerHTML:i.value},null,8,At),e.message.isStreaming&&!e.message.content?(m(),n("span",Rt,[...o[0]||(o[0]=[s("span",{class:"typing-dot w-2 h-2 bg-zinc-400 rounded-full"},null,-1),s("span",{class:"typing-dot w-2 h-2 bg-zinc-400 rounded-full"},null,-1),s("span",{class:"typing-dot w-2 h-2 bg-zinc-400 rounded-full"},null,-1)])])):e.message.isStreaming?(m(),n("span",It)):a("",!0)])])],2))}}),[["__scopeId","data-v-e9b152bc"]]),Wt={class:"border-t border-zinc-800 bg-chat-bg p-4"},Vt={class:"max-w-3xl mx-auto"},Gt={class:"relative flex items-end gap-2 bg-input-bg rounded-xl p-2"},$t=["disabled"],Xt=["disabled"],Yt={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Qt={key:1,class:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24"},Zt=e({__name:"InputArea",props:{disabled:{type:Boolean},isLoading:{type:Boolean},sendDisabled:{type:Boolean}},emits:["send"],setup(e,{emit:i}){const o=e,l=i,a=t(""),c=t(null);function u(){!a.value.trim()||o.disabled||o.isLoading||o.sendDisabled||(l("send",a.value),a.value="",c.value&&(c.value.style.height="auto"))}function d(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),u())}return x(a,function(){c.value&&(c.value.style.height="auto",a.value.trim()&&(c.value.style.height=Math.min(c.value.scrollHeight,200)+"px"))}),(t,i)=>(m(),n("div",Wt,[s("div",Vt,[s("div",Gt,[p(s("textarea",{ref_key:"textareaRef",ref:c,"onUpdate:modelValue":i[0]||(i[0]=e=>a.value=e),onKeydown:d,disabled:e.disabled,placeholder:"输入消息...",rows:"1",class:"flex-1 bg-transparent text-zinc-200 placeholder-zinc-500 resize-none outline-none px-2 py-1.5 max-h-[200px]"},null,40,$t),[[h,a.value]]),s("button",{onClick:u,disabled:e.disabled||e.isLoading||!a.value.trim()||e.sendDisabled,class:r(["flex-shrink-0 p-2 rounded-lg transition-colors",[!a.value.trim()||e.disabled||e.isLoading||e.sendDisabled?"bg-zinc-700 text-zinc-500 cursor-not-allowed":"bg-btn-primary hover:bg-btn-hover text-white"]])},[e.isLoading?(m(),n("svg",Qt,[...i[2]||(i[2]=[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(m(),n("svg",Yt,[...i[1]||(i[1]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"},null,-1)])]))],10,Xt)]),i[3]||(i[3]=s("p",{class:"text-xs text-zinc-600 text-center mt-2"}," 按 Enter 发送，Shift+Enter 换行 ",-1))])]))}}),Kt={class:"flex-1 flex flex-col bg-chat-bg h-full"},qt={key:0,class:"bg-red-900/50 border-b border-red-800 px-4 py-2 text-red-200 text-sm flex items-center justify-between"},Jt={key:0,class:"h-full flex flex-col items-center justify-center text-zinc-400 px-4"},en=["src"],tn={key:1},nn=e({__name:"ChatWindow",props:{messages:{},isLoading:{type:Boolean},isConnected:{type:Boolean},error:{},sendDisabled:{type:Boolean}},emits:["send","clearError"],setup(e,{emit:i}){const r=e,c=i,v=t(null);function p(){v.value&&(v.value.scrollTop=v.value.scrollHeight)}function h(e){c("send",e)}return x(()=>r.messages.length,async()=>{await f(),p()}),x(()=>r.messages[r.messages.length-1]?.content,async()=>{await f(),p()}),(t,i)=>(m(),n("div",Kt,[e.error?(m(),n("div",qt,[s("span",null,l(e.error),1),s("button",{onClick:i[0]||(i[0]=e=>c("clearError")),class:"text-red-400 hover:text-red-300"},[...i[1]||(i[1]=[s("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[s("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)])])])):a("",!0),s("div",{ref_key:"messagesContainer",ref:v,class:"flex-1 overflow-y-auto"},[0===e.messages.length?(m(),n("div",Jt,[s("img",{src:b(Dt),alt:"Claude",class:"w-16 h-16 rounded-full mb-4"},null,8,en),i[2]||(i[2]=s("h2",{class:"text-xl font-medium text-zinc-200 mb-2"},"Claude 对话",-1)),i[3]||(i[3]=s("p",{class:"text-center max-w-md"}," 在下方输入消息开始对话 ",-1))])):(m(),n("div",tn,[(m(!0),n(o,null,u(e.messages,e=>(m(),d(Ut,{key:e.id,message:e},null,8,["message"]))),128))]))],512),y(Zt,{disabled:!e.isConnected,"is-loading":e.isLoading,"send-disabled":e.sendDisabled,onSend:h},null,8,["disabled","is-loading","send-disabled"])]))}}),sn={class:"relative bg-zinc-900 border border-zinc-700 rounded-xl shadow-2xl max-w-md w-full mx-4 animate-fadeIn"},rn={class:"p-5 border-b border-zinc-800"},on={class:"flex items-center gap-3"},ln={key:0,class:"w-10 h-10 rounded-full bg-yellow-500/20 flex items-center justify-center"},an={key:1,class:"w-10 h-10 rounded-full bg-red-500/20 flex items-center justify-center"},cn={key:2,class:"w-10 h-10 rounded-full bg-btn-primary/20 flex items-center justify-center"},un={class:"text-lg font-semibold text-white"},dn={class:"p-5"},vn={class:"p-4 border-t border-zinc-800 flex justify-end gap-3"},fn=Nt(e({__name:"Modal",props:{show:{type:Boolean},title:{},confirmText:{},cancelText:{},showCancel:{type:Boolean},type:{}},emits:["confirm","cancel"],setup(e,{emit:t}){const i=t;return(t,r)=>(m(),d(v,{to:"body"},[y(z,{name:"modal"},{default:k(()=>[e.show?(m(),n("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center",onClick:r[2]||(r[2]=g(e=>i("cancel"),["self"]))},[r[6]||(r[6]=s("div",{class:"absolute inset-0 bg-black/60 backdrop-blur-sm"},null,-1)),s("div",sn,[s("div",rn,[s("div",on,["warning"===e.type?(m(),n("div",ln,[...r[3]||(r[3]=[s("svg",{class:"w-5 h-5 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)])])):"error"===e.type?(m(),n("div",an,[...r[4]||(r[4]=[s("svg",{class:"w-5 h-5 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])])):(m(),n("div",cn,[...r[5]||(r[5]=[s("svg",{class:"w-5 h-5 text-btn-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])])),s("h3",un,l(e.title),1)])]),s("div",dn,[C(t.$slots,"default",{},void 0,!0)]),s("div",vn,[!1!==e.showCancel?(m(),n("button",{key:0,onClick:r[0]||(r[0]=e=>i("cancel")),class:"px-4 py-2 text-sm text-zinc-400 hover:text-white hover:bg-zinc-800 rounded-lg transition-colors"},l(e.cancelText||"取消"),1)):a("",!0),s("button",{onClick:r[1]||(r[1]=e=>i("confirm")),class:"px-4 py-2 text-sm bg-btn-primary hover:bg-btn-hover text-white rounded-lg transition-colors"},l(e.confirmText||"确定"),1)])])])):a("",!0)]),_:3})]))}}),[["__scopeId","data-v-bb7b6551"]]),mn=t([]),pn=t(""),hn=t([]),gn=t(!1),wn=t(!1),bn=t(!1),xn=t(""),yn=t(null),kn=t(null),zn=t(!1),Cn=t(""),_n=t(!1),Sn=t(0),jn=3e3,Mn=[];let Ln=null;function Tn(){const e=w(()=>mn.value.find(e=>e.conversation_id===pn.value)),t=w(()=>hn.value.length>0);function n(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}function s(e){try{const t=new Date(e),n=new Date,s=t.getTime()-n.getTime();if(s<=0)return"即将重置用量";const i=Math.ceil(s/6e4),r=Math.floor(i/60),o=i%60;return r>=1?o>0?`${r}小时${o}分钟后重置用量`:`${r}小时后重置用量`:`${i}分钟后重置用量`}catch{return"稍后重置用量"}}function i(){Ln&&(clearTimeout(Ln),Ln=null)}async function r(){if(!(_n.value||Sn.value>=5)){Sn.value++,wn.value=!0;try{await Ne("services.ChatService.Connect")}catch(e){const t=String(e);if(wn.value=!1,t.includes("502")||t.includes("Bad Gateway"))return void(_n.value=!0);Sn.value<5&&(Ln=setTimeout(()=>{r()},jn))}}}async function o(){try{const e=await Ne("services.UsageService.GetUsageStatus");if(kn.value=e,_n.value=!1,e.is_blocked){zn.value=!0;const t=s(e.block_reset_time);Cn.value=`${e.block_reason}\n${t}`}else zn.value=!1,Cn.value=""}catch(e){const t=String(e);(t.includes("502")||t.includes("Bad Gateway")||t.includes("decoding")||t.includes("expected value"))&&(_n.value=!0)}}async function l(){try{const e=await Ne("services.ChatService.GetLocalConversations");mn.value=(e||[]).map(e=>({conversation_id:e.conversation_id,name:e.name,first_message:e.first_message,message_count:e.message_count,last_used_time:e.last_used_time,is_generating:e.is_generating||!1}))}catch(e){}}let a=null;function c(){pn.value="",hn.value=[],yn.value=null}return{conversations:mn,currentConversationId:pn,currentConversation:e,messages:hn,isConnected:gn,isConnecting:wn,isLoading:bn,streamingContent:xn,error:yn,hasMessages:t,usageStatus:kn,usageBlocked:zn,usageBlockMessage:Cn,serverUnavailable:_n,reconnectAttempts:Sn,initialize:async function(){Mn.push(Xe("connected",()=>{gn.value=!0,wn.value=!1,yn.value=null,Sn.value=0,i(),o()})),Mn.push(Xe("disconnected",()=>{gn.value=!1,wn.value=!1,Ln=setTimeout(()=>{r()},jn)})),Mn.push(Xe("connection_error",e=>{yn.value=e,gn.value=!1,wn.value=!1,Ln=setTimeout(()=>{r()},jn)})),Mn.push(Xe("conversation_id",async e=>{if(e.conversation_id){const n=pn.value;if(pn.value=e.conversation_id,!n||n.startsWith("local_"))try{const t=a||"";await Ne("services.ChatService.CreateLocalConversation",e.conversation_id,t),a&&(await Ne("services.ChatService.SaveLocalMessage",e.conversation_id,"user",a),a=null)}catch(t){}}})),Mn.push(Xe("content",e=>{xn.value=e.text||e.delta||"";const t=hn.value[hn.value.length-1];t&&"assistant"===t.role&&t.isStreaming&&(t.content=xn.value)})),Mn.push(Xe("done",async e=>{bn.value=!1,xn.value="";const t=hn.value[hn.value.length-1];if(t&&"assistant"===t.role&&(t.content=e.response,t.isStreaming=!1,pn.value))try{await Ne("services.ChatService.SaveLocalMessage",pn.value,"assistant",e.response)}catch(n){}e.conversation_id&&!pn.value&&(pn.value=e.conversation_id),await l(),await o()})),Mn.push(Xe("ws_error",e=>{yn.value=e.error,bn.value=!1;const t=hn.value[hn.value.length-1];t&&"assistant"===t.role&&t.isStreaming&&hn.value.pop()})),Mn.push(Xe("usage_blocked",e=>{bn.value=!1,zn.value=!0;const t=s(e.block_reset_time);Cn.value=`${e.block_reason}\n${t}`;const n=hn.value[hn.value.length-1];n&&"assistant"===n.role&&n.isStreaming&&hn.value.pop();const i=hn.value[hn.value.length-1];i&&"user"===i.role&&hn.value.pop()})),await l();try{gn.value=await Ne("services.ChatService.IsConnected"),gn.value||(wn.value=!0,await Ne("services.ChatService.Connect"))}catch(e){const t=String(e);wn.value=!1,(t.includes("502")||t.includes("Bad Gateway")||t.includes("连接失败"))&&(_n.value=!0)}await o()},cleanup:function(){i(),Mn.forEach(e=>e()),Mn.length=0},sendMessage:async function(e){if(!e.trim()||bn.value)return;if(await o(),zn.value)return void(yn.value=Cn.value);yn.value=null;const t=!pn.value||pn.value.startsWith("local_");t&&(a=e.trim(),pn.value||(pn.value=await Ne("services.ChatService.GenerateConversationId")));const s={id:n(),role:"user",content:e.trim(),timestamp:new Date};if(hn.value.push(s),!t)try{await Ne("services.ChatService.SaveLocalMessage",pn.value,"user",e.trim())}catch(r){}const i={id:n(),role:"assistant",content:"",timestamp:new Date,isStreaming:!0};hn.value.push(i),bn.value=!0,xn.value="";try{const n=t?"":pn.value;await Ne("services.ChatService.SendMessage",n,e.trim())}catch(r){yn.value=String(r),bn.value=!1,hn.value.pop(),a=null}},selectConversation:async function(e){e!==pn.value&&(pn.value=e,hn.value=[],e&&await async function(e){try{const t=await Ne("services.ChatService.GetLocalMessages",e);hn.value=(t||[]).map(e=>({id:String(e.id),role:e.role,content:e.content,timestamp:new Date(e.timestamp)}))}catch(t){}}(e))},newConversation:c,reconnect:async function(){i(),Sn.value=0;try{wn.value=!0,await Ne("services.ChatService.Connect")}catch(e){yn.value=String(e),wn.value=!1}},clearError:function(){yn.value=null},loadDialogues:l,renameConversation:async function(e,t){try{await Ne("services.ChatService.RenameConversation",e,t);const n=mn.value.find(t=>t.conversation_id===e);n&&(n.name=t)}catch(n){}},deleteConversation:async function(e){try{await Ne("services.ChatService.DeleteLocalConversation",e),mn.value=mn.value.filter(t=>t.conversation_id!==e),pn.value===e&&c()}catch(t){}},fetchUsageStatus:o}}const En="# 请勿滥用\n\n这个软件本质上是在使用我200美元一个月的Max订阅额度 并且依赖后端服务器运行 当短期用量或周用量达到设定值就会暂时停止服务 因此 为了不影响你自己以及其他人的正常使用 **请勿**做出以下行为\n\n- 发送无意义的信息\n\n- 重复发送相同内容 除非你对回复感到不满意\n\n- 让一个对话内容过长 我没有限制上下文长度 因此过长的对话会**极速**消耗用量\n\n- 用客户端玩卡 (这个客户端是用来给作者写卡的！)\n\n**请文明有序地使用公共资源 如果您的行为被系统评估为高滥用风险 会被自动封禁**",Dn={class:"flex h-screen bg-chat-bg text-white"},Pn={class:"space-y-4"},Bn={class:"flex items-center gap-4 text-sm"},Fn={class:"text-zinc-400"},On={class:"text-zinc-200"},Hn={class:"text-zinc-400"},An={class:"text-btn-primary font-medium"},Rn={class:"bg-zinc-800/50 rounded-lg p-4"},In={class:"space-y-1"},Nn={key:0,class:"pt-2"},Un=["innerHTML"],Wn={key:0,class:"fixed inset-0 z-[10000] bg-black/90 flex items-center justify-center"},Vn={class:"bg-zinc-900 border border-orange-500/50 rounded-xl p-8 max-w-md mx-4 shadow-2xl"},Gn={class:"space-y-4"},$n={class:"text-zinc-300"},Xn={class:"bg-zinc-800/50 rounded-lg p-4"},Yn={class:"flex items-center gap-4 text-sm mb-3"},Qn={class:"text-zinc-400"},Zn={class:"text-zinc-200"},Kn={class:"text-zinc-400"},qn={class:"text-orange-400 font-medium"},Jn={key:0,class:"pt-2"},es={class:"bg-zinc-900 border border-red-500/50 rounded-xl p-8 max-w-md mx-4 shadow-2xl"},ts={class:"space-y-4"},ns={class:"bg-zinc-800/50 rounded-lg p-4"},ss=["innerHTML"],is={class:"bg-zinc-900 border border-orange-500/50 rounded-xl p-8 max-w-md mx-4 shadow-2xl"},rs={class:"space-y-4"},os={class:"text-zinc-300 whitespace-pre-line"},ls={class:"bg-zinc-900 border border-red-500/50 rounded-xl p-8 max-w-md mx-4 shadow-2xl"},as={class:"space-y-4"};M(e({__name:"App",setup(e){const{conversations:r,currentConversationId:c,messages:d,isConnected:v,isConnecting:f,isLoading:p,error:h,usageStatus:x,usageBlocked:z,usageBlockMessage:C,serverUnavailable:M,reconnectAttempts:T,initialize:E,cleanup:D,sendMessage:P,selectConversation:B,newConversation:F,reconnect:O,clearError:H,renameConversation:A,deleteConversation:R}=Tn(),I=t(!1),N=t(null),U=t(""),W=t(!1),V=t(!1),G=t(""),$=t(!1),X=t(null),Y=t(!1),Q=t(En),Z=t(!0),K=t(!0);let q=null,J=null,ee=null;const te=w(()=>Q.value?L(Q.value):""),ne=w(()=>G.value?L(G.value):""),se=w(()=>V.value||z.value||$.value||M.value||!v.value);async function ie(){var e;N.value?.download_url&&(e=N.value.download_url,ae(0,{url:e.toString()}))}function re(){Y.value=!1}async function oe(){try{U.value=await Ne("services.UpdateService.GetCurrentVersion");const e=await Ne("services.UpdateService.CheckForUpdate");e.has_update&&(N.value=e,I.value=!0)}catch(e){}}function le(){I.value=!1}function ce(){W.value=!1}function ue(e){P(e)}function de(e){B(e)}function ve(e,t){A(e,t)}function fe(e){R(e)}return _(async()=>{E(),En.trim()&&(Y.value=!0),oe(),q=Xe("connection_error",e=>{(e.includes("claude.nixdorfer.com")||e.includes("连接失败")||e.includes("dial"))&&(W.value=!0)}),J=Xe("device_banned",e=>{G.value=e.reason||"您的设备已被封禁",V.value=!0}),ee=Xe("version_outdated",async e=>{X.value=e,$.value=!0,await oe()})}),S(()=>{D(),q&&q(),J&&J(),ee&&ee()}),(e,t)=>(m(),n("div",Dn,[y(Et,{conversations:b(r),"current-id":b(c),"is-connected":b(v),"is-connecting":b(f),"reconnect-attempts":b(T),"usage-status":b(x),"usage-blocked":b(z),"usage-block-message":b(C),version:U.value,onSelect:de,onNewChat:b(F),onReconnect:b(O),onRename:ve,onDelete:fe},null,8,["conversations","current-id","is-connected","is-connecting","reconnect-attempts","usage-status","usage-blocked","usage-block-message","version","onNewChat","onReconnect"]),y(nn,{messages:b(d),"is-loading":b(p),"is-connected":b(v),error:b(h),"send-disabled":se.value,onSend:ue,onClearError:b(H)},null,8,["messages","is-loading","is-connected","error","send-disabled","onClearError"]),y(fn,{show:I.value,title:"发现新版本","confirm-text":"知道了","show-cancel":!1,type:"info",onConfirm:le,onCancel:le},{default:k(()=>[s("div",Pn,[s("div",Bn,[s("div",Fn,[t[6]||(t[6]=i(" 当前版本: ",-1)),s("span",On,l(N.value?.current_version),1)]),t[8]||(t[8]=s("svg",{class:"w-4 h-4 text-zinc-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7l5 5m0 0l-5 5m5-5H6"})],-1)),s("div",Hn,[t[7]||(t[7]=i(" 最新版本: ",-1)),s("span",An,l(N.value?.latest_version),1)])]),s("div",Rn,[t[10]||(t[10]=s("h4",{class:"text-sm font-medium text-zinc-300 mb-2"},"更新内容:",-1)),s("ul",In,[(m(!0),n(o,null,u(N.value?.notes,(e,i)=>(m(),n("li",{key:i,class:"text-sm text-zinc-400 flex items-start gap-2"},[t[9]||(t[9]=s("span",{class:"text-btn-primary mt-1"},"-",-1)),s("span",null,l(e),1)]))),128))])]),N.value?.download_url?(m(),n("div",Nn,[s("button",{onClick:ie,class:"w-full py-2 px-4 bg-btn-primary hover:bg-btn-hover text-white rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2"},[...t[11]||(t[11]=[s("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),i(" 前往下载页面 ",-1)])])])):a("",!0)])]),_:1},8,["show"]),y(fn,{show:W.value,title:"连接失败","confirm-text":"知道了","show-cancel":!1,type:"error",onConfirm:ce,onCancel:ce},{default:k(()=>[...t[12]||(t[12]=[s("div",{class:"space-y-4"},[s("p",{class:"text-zinc-300"}," 无法连接至服务器，服务器可能已经关闭。 "),s("div",{class:"bg-zinc-800/50 rounded-lg p-4"},[s("p",{class:"text-sm text-zinc-400 mb-2"},"请联系系统管理员:"),s("div",{class:"space-y-1 text-sm"},[s("p",{class:"text-zinc-300"},[i("Discord / Telegram / QQ: "),s("span",{class:"text-btn-primary"},"@Nixdorfer")])])])],-1)])]),_:1},8,["show"]),y(fn,{show:Y.value,title:"公告","confirm-text":"确定","show-cancel":!1,type:"info",onConfirm:re,onCancel:re},{default:k(()=>[s("div",{class:"prose prose-invert prose-sm max-w-none",innerHTML:te.value},null,8,Un)]),_:1},8,["show"]),$.value?(m(),n("div",Wn,[s("div",Vn,[t[19]||(t[19]=j('<div class="flex items-center gap-3 mb-6"><div class="w-12 h-12 bg-orange-500/20 rounded-full flex items-center justify-center"><svg class="w-6 h-6 text-orange-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg></div><h2 class="text-xl font-bold text-orange-500">版本已过时</h2></div>',1)),s("div",Gn,[s("p",$n,l(X.value?.message),1),s("div",Xn,[s("div",Yn,[s("div",Qn,[t[13]||(t[13]=i(" 当前版本: ",-1)),s("span",Zn,l(X.value?.current_version),1)]),t[15]||(t[15]=s("svg",{class:"w-4 h-4 text-zinc-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7l5 5m0 0l-5 5m5-5H6"})],-1)),s("div",Kn,[t[14]||(t[14]=i(" 最低要求: ",-1)),s("span",qn,l(X.value?.required_version),1)])]),t[16]||(t[16]=s("p",{class:"text-sm text-zinc-400"},"请下载最新版本后重新打开应用",-1))]),N.value?.download_url?(m(),n("div",Jn,[s("button",{onClick:ie,class:"w-full py-2 px-4 bg-orange-500 hover:bg-orange-600 text-white rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2"},[...t[17]||(t[17]=[s("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),i(" 前往下载页面 ",-1)])])])):a("",!0),t[18]||(t[18]=s("p",{class:"text-xs text-zinc-500 text-center"}," 此窗口无法关闭 ",-1))])])])):a("",!0),V.value?(m(),n("div",{key:1,class:"fixed inset-0 z-[9999] bg-black/90 flex items-center justify-center",onClick:t[1]||(t[1]=g(e=>V.value=!1,["self"]))},[s("div",es,[t[22]||(t[22]=j('<div class="flex items-center gap-3 mb-6"><div class="w-12 h-12 bg-red-500/20 rounded-full flex items-center justify-center"><svg class="w-6 h-6 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"></path></svg></div><h2 class="text-xl font-bold text-red-500">设备已被封禁</h2></div>',1)),s("div",ts,[s("div",ns,[t[20]||(t[20]=s("p",{class:"text-sm text-zinc-400 mb-2"},"管理员留言:",-1)),s("div",{class:"text-zinc-300 prose prose-sm prose-invert max-w-none",innerHTML:ne.value},null,8,ss)]),t[21]||(t[21]=j('<div class="bg-zinc-800/50 rounded-lg p-4"><p class="text-sm text-zinc-400 mb-2">如有疑问请联系管理员:</p><div class="space-y-1 text-sm"><p class="text-zinc-300">Discord / Telegram / QQ: <span class="text-btn-primary">@Nixdorfer</span></p></div></div>',1)),s("button",{class:"w-full py-2 bg-zinc-700 hover:bg-zinc-600 rounded-lg text-sm text-zinc-300",onClick:t[0]||(t[0]=e=>V.value=!1)}," 关闭 (仅可查看历史对话) ")])])])):a("",!0),b(z)&&Z.value?(m(),n("div",{key:2,class:"fixed inset-0 z-[9998] bg-black/90 flex items-center justify-center",onClick:t[3]||(t[3]=g(e=>Z.value=!1,["self"]))},[s("div",is,[t[24]||(t[24]=j('<div class="flex items-center gap-3 mb-6"><div class="w-12 h-12 bg-orange-500/20 rounded-full flex items-center justify-center"><svg class="w-6 h-6 text-orange-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg></div><h2 class="text-xl font-bold text-orange-500">已超过管理员设定用量</h2></div>',1)),s("div",rs,[s("p",os,l(b(C)),1),t[23]||(t[23]=j('<div class="bg-zinc-800/50 rounded-lg p-4"><p class="text-sm text-zinc-400 mb-2">如有疑问请联系管理员:</p><div class="space-y-1 text-sm"><p class="text-zinc-300">Discord / Telegram / QQ: <span class="text-btn-primary">@Nixdorfer</span></p></div></div>',1)),s("button",{class:"w-full py-2 bg-zinc-700 hover:bg-zinc-600 rounded-lg text-sm text-zinc-300",onClick:t[2]||(t[2]=e=>Z.value=!1)}," 关闭 (仅可查看历史对话) ")])])])):a("",!0),b(M)&&K.value?(m(),n("div",{key:3,class:"fixed inset-0 z-[9997] bg-black/90 flex items-center justify-center",onClick:t[5]||(t[5]=g(e=>K.value=!1,["self"]))},[s("div",ls,[t[26]||(t[26]=j('<div class="flex items-center gap-3 mb-6"><div class="w-12 h-12 bg-red-500/20 rounded-full flex items-center justify-center"><svg class="w-6 h-6 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"></path></svg></div><h2 class="text-xl font-bold text-red-500">服务器暂时不可用</h2></div>',1)),s("div",as,[t[25]||(t[25]=j('<p class="text-zinc-300"> 服务器暂时关闭或遇到异常，请稍后再试。 </p><div class="bg-zinc-800/50 rounded-lg p-4"><p class="text-sm text-zinc-400 mb-2">如有疑问请联系管理员:</p><div class="space-y-1 text-sm"><p class="text-zinc-300">Telegram / Discord / QQ: <span class="text-btn-primary">@Nixdorfer</span></p></div></div>',2)),s("button",{class:"w-full py-2 bg-zinc-700 hover:bg-zinc-600 rounded-lg text-sm text-zinc-300",onClick:t[4]||(t[4]=e=>K.value=!1)}," 关闭 (仅可查看历史对话) ")])])])):a("",!0)]))}})).mount("#app");
