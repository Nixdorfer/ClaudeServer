# Claude API 配置文件
# 请根据实际情况修改以下配置

# ============================================================================
# 认证 Token 配置（新版推荐配置方式）
# ============================================================================
#
# 【最小化配置策略】
# 你可以只填写必需的字段，其他字段留空。程序会自动忽略空字段。
# 如果遇到认证失败，可以逐步添加更多字段进行测试。
#
# 必需字段：
#   - organization_id (必需)
#   - session_key (必需)
#
# 可选字段（按重要性排序）：
#   1. cf_clearance, cf_bm - MCP WebSocket 连接可能需要
#   2. device_id, anonymous_id - 提高稳定性
#   3. 其他字段 - 增强浏览器模拟，但通常不是必需的
#
# ============================================================================
tokens:
  # --- 核心认证信息（必需）---
  organization_id: "你的组织ID"      # 从 claude.ai URL 中获取 (organizations/后面的UUID)
  session_key: "你的sessionKey值"    # 从浏览器 Cookie 中的 sessionKey 字段获取

  # --- Cloudflare 验证 Token（MCP WebSocket 可能需要）---
  # 如果你需要使用 MCP (Model Context Protocol) 功能，建议填写以下两项
  # 如果不使用 MCP，可以留空
  # 获取方法：打开浏览器开发者工具 (F12) -> Network -> 找到任意 claude.ai 请求
  #          -> 查看 Request Headers -> Cookie 字段 -> 复制对应的值
  cf_clearance: ""     # Cloudflare 验证 token (例如: rzdTtj7Y1DQfn7O_LTuthkeUIO89rObpj7AJwjEbHkI-1762365749-...)
  cf_bm: ""            # Cloudflare Bot Management token (例如: JtU6Q9XdyZoE0rtAM2rW.FeTYpOw8vYE_...)

  # --- 设备和用户标识（建议提供，但非必需）---
  device_id: ""        # anthropic-device-id (例如: bf4867fd-1cbf-4778-933f-c5d8eb8aa670)
  anonymous_id: ""     # ajs_anonymous_id (例如: d5a52e83-fad9-435c-8c21-6d4e1fe76116)

  # --- 其他可选 Token（可选，用于更完整的浏览器模拟）---
  # 这些 token 可以进一步降低被识别为机器人的风险，但通常不是必需的
  # 如果基本功能正常工作，可以不填写这些字段
  user_id: ""              # ajs_user_id
  activity_session_id: ""  # activitySessionId
  intercom_device_id: ""   # intercom-device-id-lupk8zyo
  intercom_session_id: ""  # intercom-session-lupk8zyo

# ============================================================================
# 如何获取这些 Token？
# ============================================================================
# 1. 打开浏览器访问 https://claude.ai 并登录
# 2. 按 F12 打开开发者工具
# 3. 切换到 "Application"（应用）或 "Storage"（存储）标签
# 4. 在左侧找到 "Cookies" -> "https://claude.ai"
# 5. 在右侧的 Cookie 列表中，找到需要的字段并复制其值
#
# 或者通过 Network 标签获取：
# 1. 切换到 "Network"（网络）标签
# 2. 刷新页面或进行任意操作
# 3. 在请求列表中选择任意一个请求（建议选择 API 请求）
# 4. 在右侧面板找到 "Request Headers"（请求头）
# 5. 找到 "Cookie" 字段，展开查看所有 cookie 项
# 6. 按照上面的字段名，复制对应的值到配置文件中
#
# 示例 Cookie 内容：
#   sessionKey=sk-ant-sid01-xxx;
#   anthropic-device-id=bf4867fd-1cbf-4778-933f-c5d8eb8aa670;
#   cf_clearance=rzdTtj7Y1DQfn7O_LTuthkeUIO89rObpj7AJwjEbHkI-xxx;
#   __cf_bm=JtU6Q9XdyZoE0rtAM2rW.FeTYpOw8vYE_oATI_obEk8-xxx;
#   ajs_anonymous_id=d5a52e83-fad9-435c-8c21-6d4e1fe76116;
#   ...
#
# 【逐步测试策略】
# 如果不确定哪些字段是必需的，可以按以下步骤测试：
# 1. 首先只填写 organization_id 和 session_key，测试基本功能
# 2. 如果 MCP WebSocket 连接失败，添加 cf_clearance 和 cf_bm
# 3. 如果仍有问题，逐步添加 device_id 和 anonymous_id
# 4. 其他字段通常不需要，除非遇到特定的认证问题
#
# 注意：
#   - cf_clearance 和 __cf_bm 有时效性，过期后需要重新获取
#   - 不要分享这些 token 给他人，它们可以用来访问你的 Claude 账户
#   - 在配置文件中，__cf_bm 对应的字段名是 cf_bm（不带下划线前缀）
# ============================================================================

# 服务配置
debug: false           # 调试模式
thread_num: 5          # 并发线程数
server_port: 5000      # 服务端口
api_endpoint: "http://localhost:5000"

# 代理配置
proxy:
  enable: false        # 是否启用代理
  http: ""             # HTTP 代理地址，格式: http://proxy.example.com:8080
  https: ""            # HTTPS 代理地址，格式: http://proxy.example.com:8080

# 速率限制
max_tpm: 100000        # 最大 Token/分钟
max_rpm: 50            # 最大请求/分钟
max_rpd: 3000          # 最大请求/天
request_interval_ms: 0 # 请求间隔(毫秒)

# 数据库配置
db_host: "localhost"
db_port: 5432
db_user: "postgres"
db_password: "xdfrt123"
db_name: "claude_db"

# 模型配置
models:
  - id: "claude-sonnet-4-20250514"
    object: "model"
  - id: "claude-opus-4-20250514"
    object: "model"
  - id: "claude-3-5-sonnet-20241022"
    object: "model"
  # RiMind/Ollama 兼容的模型别名
  - id: "sonnet-4.5"
    object: "model"
  - id: "Sonnet-4.5"
    object: "model"
  - id: "claude-sonnet-4.5"
    object: "model"

# 默认模型
default_model: "claude-sonnet-4-20250514"

# 样式配置
default_style: "normal"
styles:
  - key: "normal"
    name: "正常"
    summary: "默认回复样式"
    prompt: ""
  - key: "concise"
    name: "简洁"
    summary: "简短精炼的回复"
    prompt: "请用简洁的语言回答，避免冗余。"
  - key: "detailed"
    name: "详细"
    summary: "详细完整的回复"
    prompt: "请提供详细完整的回答，包含相关的解释和示例。"

# MCP Connector 配置
# Model Context Protocol 连接器，用于扩展 Claude 的能力
# 使用 ./claude-adapter -t 命令测试MCP连接
mcp_connectors:
  # 示例配置 - 云壳MCP服务器
  # 注意：MCP服务器的URL、OAuth等配置已经在claude.ai网页上完成
  # 这里只需要配置name和uuid即可
  # - name: "云壳"                                     # 显示名称
  #   uuid: "fc8fdf60-9a35-43ff-97e0-a5ca4b0047ea"   # Claude.ai中的服务器UUID
  #   enabled: true                                   # 是否启用此连接器进行测试
  #
  # 如何获取UUID:
  # 1. 在claude.ai网页中配置MCP服务器（包括URL、OAuth等）
  # 2. 打开浏览器开发者工具 -> Network
  # 3. 查看 /mcp/remote_servers 请求的响应
  # 4. 复制对应服务器的uuid字段
  #
  # 示例配置 - 多个MCP服务器
  # - name: "云壳"
  #   uuid: "fc8fdf60-9a35-43ff-97e0-a5ca4b0047ea"
  #   enabled: true
  # - name: "另一个MCP"
  #   uuid: "another-server-uuid"
  #   enabled: false
